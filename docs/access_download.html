<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.510">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ALA Data Cleaning - 6&nbsp; Download data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./access_inspect.html" rel="next">
<link href="./access_taxonomy.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg border-bottom" data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">ALA Data Cleaning</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./access_intro.html">Accessing biodiversity data</a></li><li class="breadcrumb-item"><a href="./access_download.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Download data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./scope.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data scope</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scope_temporal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Temporal scope</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scope_taxonomic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Taxonomic scope</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scope_spatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Spatial scope</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scope_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data scope summary</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./access_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Accessing biodiversity data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./access_taxonomy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Taxnomy and open source data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./access_download.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Download data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./access_inspect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Initial inspection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./access_integration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dataset integration</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./cleaning_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning biodiversity data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cleaning_standardisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">General utility functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cleaning_duplicates.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Duplicates and missing records</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cleaning_manipulating_strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Strings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cleaning_taxonomy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Taxonomy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cleaning_taxonomic_validation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Taxonomic validation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cleaning_geospatial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Geospatial data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./outliers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Outliers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Appendix</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#where-to-get-data-from" id="toc-where-to-get-data-from" class="nav-link active" data-scroll-target="#where-to-get-data-from"><span class="header-section-number">6.1</span> Where to get data from</a></li>
  <li><a href="#packages-for-downloading-data" id="toc-packages-for-downloading-data" class="nav-link" data-scroll-target="#packages-for-downloading-data"><span class="header-section-number">6.2</span> Packages for downloading data</a></li>
  <li><a href="#basic-downloads-via-galah" id="toc-basic-downloads-via-galah" class="nav-link" data-scroll-target="#basic-downloads-via-galah"><span class="header-section-number">6.3</span> Basic downloads via <code>galah</code></a>
  <ul class="collapse">
  <li><a href="#setting-an-atlas" id="toc-setting-an-atlas" class="nav-link" data-scroll-target="#setting-an-atlas"><span class="header-section-number">6.3.1</span> Setting an atlas</a></li>
  <li><a href="#download-from-gbif" id="toc-download-from-gbif" class="nav-link" data-scroll-target="#download-from-gbif"><span class="header-section-number">6.3.2</span> Download from GBIF</a></li>
  <li><a href="#download-from-a-regional-node" id="toc-download-from-a-regional-node" class="nav-link" data-scroll-target="#download-from-a-regional-node"><span class="header-section-number">6.3.3</span> Download from a regional node</a></li>
  <li><a href="#return-specific-data-fields" id="toc-return-specific-data-fields" class="nav-link" data-scroll-target="#return-specific-data-fields"><span class="header-section-number">6.3.4</span> Return specific data fields</a></li>
  </ul></li>
  <li><a href="#taxonomic-queries" id="toc-taxonomic-queries" class="nav-link" data-scroll-target="#taxonomic-queries"><span class="header-section-number">6.4</span> Taxonomic queries</a>
  <ul class="collapse">
  <li><a href="#name-discrepancies" id="toc-name-discrepancies" class="nav-link" data-scroll-target="#name-discrepancies"><span class="header-section-number">6.4.1</span> Name discrepancies</a></li>
  </ul></li>
  <li><a href="#spatial-filtering" id="toc-spatial-filtering" class="nav-link" data-scroll-target="#spatial-filtering"><span class="header-section-number">6.5</span> Spatial filtering</a>
  <ul class="collapse">
  <li><a href="#filter-by-region" id="toc-filter-by-region" class="nav-link" data-scroll-target="#filter-by-region"><span class="header-section-number">6.5.1</span> Filter by region</a></li>
  <li><a href="#filter-by-vector-geometry" id="toc-filter-by-vector-geometry" class="nav-link" data-scroll-target="#filter-by-vector-geometry"><span class="header-section-number">6.5.2</span> Filter by vector geometry</a></li>
  <li><a href="#filter-by-bounding-box" id="toc-filter-by-bounding-box" class="nav-link" data-scroll-target="#filter-by-bounding-box"><span class="header-section-number">6.5.3</span> Filter by bounding box</a></li>
  </ul></li>
  <li><a href="#refining-your-download-query" id="toc-refining-your-download-query" class="nav-link" data-scroll-target="#refining-your-download-query"><span class="header-section-number">6.6</span> Refining your download query</a>
  <ul class="collapse">
  <li><a href="#by-year" id="toc-by-year" class="nav-link" data-scroll-target="#by-year"><span class="header-section-number">6.6.1</span> By Year</a></li>
  <li><a href="#basis-of-record" id="toc-basis-of-record" class="nav-link" data-scroll-target="#basis-of-record"><span class="header-section-number">6.6.2</span> Basis of record</a></li>
  <li><a href="#assertions" id="toc-assertions" class="nav-link" data-scroll-target="#assertions"><span class="header-section-number">6.6.3</span> Assertions</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./access_intro.html">Accessing biodiversity data</a></li><li class="breadcrumb-item"><a href="./access_download.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Download data</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-download-data" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Download data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!--                              Notes/Andrew:                              -->
<!------------------------------------------------------------------------------
I feel like there should be at least a some code demonstrating basic download
with a couple of the other mentioned packages, like spocc, and then moving on to
galah specific. Thoughts?

Changes: This section had a confusing structure to me, so I've changed it to
reflect how I think it should flow but its still a work in progress. Before, the
first chunk of code that demonstrated downloading data was closely tied to
taxonomy and naming discrepancies, which I think it's a bit much going on for a
first demonstration of downloading. I think an inverted pyramid appraoch should
be followed here (and in general across the book) - start with simple downloads,
and then building up to more complex queries from there. Following the
fundamentals, thats when I think you can show the examples that relate to or
showcase more specific issues (e.g. taxonomic name variation etc, like the
orchid example), can go. This makes the more basic instructions and code
demonstrations clearer and also easier to find and use, as a quick reference,
and for cross references, rather than having only complex examples or examples
that showcase more than one concept or functionality, which can be harder to
index and cross reference.
------------------------------------------------------------------------------->
<p>Having decided on the scope of data required, we can get started with downloading data. We will discuss where and how to get data, as well as different techniques to refine your downloads.</p>
<section id="where-to-get-data-from" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="where-to-get-data-from"><span class="header-section-number">6.1</span> Where to get data from</h2>
<p>There are a wide variety of data aggregators available online, ranging from more regional or localised records, to those with a global scope. We will introduce a few of the most common ones.</p>
<p>One of the largest biodiversity aggregators is the <a href="https://www.gbif.org/">Global Biodiversity Information Facility (GBIF)</a>, an international network and data infrastructure that provides open access biodiversity data from many sources around the world. Presently, GBIF manages and serves over 1.5 billion occurrence data points. These data points are aggregated from a number of particpant organisations, each of which collate biodiversity data from their own regions and sources, to be distributed through a designated ‘node’, with GBIF acting as the overarching organisation to store and provide this data using a unified data standard.</p>
<p>In addition to GBIF, there are a variety of other well known aggregators that index a large amount of records, such as <a href="https://www.idigbio.org">Integrated Digitzed Biocollections</a> and <a href="https://www.vertnet.org/">VertNet</a>.</p>
<p>Besides these large scale aggregators, we can also download data dierectly from more localised aggregators, such as the regional nodes of GBIF. For example, the <a href="www.ala.org.au">Atlas of Living Australia (ALA)</a> is the Australian node, <a href="https://www.sibbr.gov.br/">Sistema de Informação sobre a Biodiversidade Brasileira (SiBBr)</a> is the Brazilian node, and <a href="https://www.gbif.se/">GBIF Sweden</a> is the Swedish node. Living Atlases like the ALA ingest and aggregate data from a broad range of providers such as government monitoring programs, museums and herbaria, research projects and citizen science initiatives. If your project is focused on a specific region, downloading data directly from a regional node may be more appropriate.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>To see what national and regional nodes exist, check out <a href="https://www.gbif.org/the-gbif-network">The GBIF Network</a>.</p>
</div>
</div>
<p>If your project relates to data from a specific data provider, it also might be best to download data directly from the source. For example, a common citizen science tool to collect species observations is <a href="https://www.inaturalist.org/">iNaturalist</a>. Downloading directly from the original data source can help to ensure you don’t have any stray data from other sources.</p>
</section>
<section id="packages-for-downloading-data" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="packages-for-downloading-data"><span class="header-section-number">6.2</span> Packages for downloading data</h2>
<p>There are a range of R packages available for accessing biodiversity data. These packages serve as convenient interfaces to various data providers. By wrapping the respective APIs of data providers, they streamline the process of accessing and downloading datasets, directly within R. The functionality offered by these packages typically ranges from querying species occurrence records, to more comprehensive taxonomic and spatial download queries. Below, we highlight some commonly used packages. We encourage users to explore the documentation of each package to understand their capabilities, which will help you select one (or more!) that align with your specific needs.</p>
<ul>
<li><a href="https://docs.ropensci.org/rgbif/">rgbif</a> - Search and retrieve data from the Global Biodiversity Information Facility (GBIF)</li>
<li><a href="https://galah.ala.org.au/index.html">galah</a> - An interface for accessing GBIF and GBIF network nodes that maintain their own APIs (i.e.&nbsp;the <a href="https://galah.ala.org.au/R/articles/choosing_an_atlas.html">‘living atlases’</a>)</li>
<li><a href="https://docs.ropensci.org/rinat/">rinat</a> - An R wrapper for accessing <a href="https://www.inaturalist.org">iNaturalist</a> observations</li>
<li><a href="https://docs.ropensci.org/rebird/">rebird</a> - Provides access to the <a href="https://ebird.org/home">eBird</a> webservices.</li>
<li><a href="https://docs.ropensci.org/spocc/">spocc</a> - Query and collect species occurrence data from a variety of sources, including GBIF, ALA, <a href="https://github.com/ropensci/rvertnet">VertNet</a>, <a href="http://www.idigbio.org/">iDigBio</a> and others.</li>
</ul>
</section>
<section id="basic-downloads-via-galah" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="basic-downloads-via-galah"><span class="header-section-number">6.3</span> Basic downloads via <code>galah</code></h2>
<p>In the majority of examples we will be using the <code>galah</code> package for download queries. One benefit of using <code>galah</code> is that in addition to species occurrence records, we can specify what metadata to return, from all available fields. It also allows access to any media, such as images or sounds, associated with the occurrence records.</p>
<section id="setting-an-atlas" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="setting-an-atlas"><span class="header-section-number">6.3.1</span> Setting an atlas</h3>
<p>With <code>galah</code>, records are downloaded from the configured atlas. You can set the atlas using <code>galah_config()</code>. For example, to set the atlas to the Global Biodiversity Information Facility (GBIF), enter your GBIF account credentials and set the atlas to “Global”. See <code>?galah_config</code> for more configuration options. You can enter your details directly, or else <a href="https://docs.ropensci.org/rgbif/articles/gbif_credentials.html">save them</a> in your <code>.Renviron</code>, so you don’t have to enter them explicitly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(galah)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">galah_config</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">atlas    =</span> <span class="st">"Global"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">email    =</span> <span class="fu">Sys.getenv</span>(<span class="st">"GBIF_EMAIL"</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">username =</span> <span class="fu">Sys.getenv</span>(<span class="st">"GBIF_USER"</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">password =</span> <span class="fu">Sys.getenv</span>(<span class="st">"GBIF_PWD"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="download-from-gbif" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="download-from-gbif"><span class="header-section-number">6.3.2</span> Download from GBIF</h3>
<p>For a basic download query, we simply pass a taxonomic identifier to the <code>galah_identify()</code> function, and end our query with <code>atlas_occurrences()</code> to return a data frame from the query. This is similar to the queries we made in <a href="scope_temporal.html" class="quarto-xref"><span>Chapter&nbsp;1</span></a>, except there we used <code>atlas_counts()</code> to return counts of records rather than the observation data itself. Below is an example using the species name of the African Elephant, <em>Loxodonta africana</em>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Depending on your connection speed, downloads such as this (&gt; 1700 records) may take some time to complete</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>african_ele <span class="ot">&lt;-</span> <span class="fu">galah_call</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_identify</span>(<span class="st">"Loxodonta africana"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">atlas_occurrences</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Checking queue
 succeeded </code></pre>
</div>
</div>
<p>Downloaded records can be saved locally using <code>write.csv()</code> or <code>readr::write_csv</code> as with any other dataframe. For larger downloads, we recommend saving the data as a Parquet file, as the compression and read/write speeds are typically better for this type of data structure. We can do this using the <code>arrow::write_parquet()</code> function, and <code>arrow::read_parquet()</code> can be used to read in a parquet file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>arrow<span class="sc">::</span><span class="fu">write_parquet</span>(african_ele, <span class="st">"data/gbif/elephant"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>elephant <span class="ot">&lt;-</span> arrow<span class="sc">::</span><span class="fu">read_parquet</span>(<span class="st">"data/gbif/elephant"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="download-from-a-regional-node" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="download-from-a-regional-node"><span class="header-section-number">6.3.3</span> Download from a regional node</h3>
<p>Above, we downloaded records from GBIF. To access data from the Australian node, we change the <code>galah</code> configuration so that our query points to Australia. After that, we will download all records for the Pink Robin.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">galah_config</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">email =</span> <span class="fu">Sys.getenv</span>(<span class="st">"ALA_EMAIL"</span>),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">atlas =</span> <span class="st">"Australia"</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>pink_robin <span class="ot">&lt;-</span> <span class="fu">galah_call</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_identify</span>(<span class="st">"Petroica rodinogaster"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">atlas_occurrences</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Checking queue
Current queue size: 1 inqueue . running .</code></pre>
</div>
</div>
</section>
<section id="return-specific-data-fields" class="level3" data-number="6.3.4">
<h3 data-number="6.3.4" class="anchored" data-anchor-id="return-specific-data-fields"><span class="header-section-number">6.3.4</span> Return specific data fields</h3>
<p>When downloading data using <code>atlas_occurrences</code>, a default selection of data fields (columns) are returned, which includes some of the key taxonomic and spatial fields. There are fields for a wide array of metadata that may accompany an observation. To choose what fields are included in a download query, the <a href="https://galah.ala.org.au/R/reference/galah_select.html"><code>galah_select</code></a> function can be used. This function takes a vector of field names as an argument, and when used within a query, a tibble with only those fields will be returned. To see the fields available for selection use <code>show_all(fields)</code>.</p>
<p>Below is an example of using <code>galah_select()</code> to download only the requested data fields, for records of the species <code>Petroica rodinogaster</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(galah)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">galah_config</span>(<span class="at">email =</span> <span class="fu">Sys.getenv</span>(<span class="st">"ALA_EMAIL"</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>project_fields <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"recordID"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"eventDate"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"basisOfRecord"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"occurrenceStatus"</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"scientificName"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"genus"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"decimalLatitude"</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"decimalLongitude"</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>pink_robin_projfields <span class="ot">&lt;-</span> <span class="fu">galah_call</span>() <span class="sc">|&gt;</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_identify</span>(<span class="st">"Petroica rodinogaster"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_select</span>(<span class="fu">all_of</span>(project_fields)) <span class="sc">|&gt;</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">atlas_occurrences</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Checking queue
Current queue size: 1 inqueue . running </code></pre>
</div>
</div>
</section>
</section>
<section id="taxonomic-queries" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="taxonomic-queries"><span class="header-section-number">6.4</span> Taxonomic queries</h2>
<p>Techniques specific to taxonomic queries and related knowledge.</p>
<section id="name-discrepancies" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="name-discrepancies"><span class="header-section-number">6.4.1</span> Name discrepancies</h3>
<!-- Andrew: what does this mean, needs some context -->
<p>To search by a taxonomic classification, include the original name that was recorded by the data provider in your download.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Orchid as an example</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in problem child data and show</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by species and count unique values for higher taxonomy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Orchids (family <em>Orchidaceae</em>) are one taxonomic clade that naming authorities have (famously) differing opinions about taxonomic classification. Comparing the scientific name originally provided with the observation by the data provider (i.e.&nbsp;<code>raw_scientificName</code>) compared to the name held within the Atlas of Living Australia (i.e.&nbsp;`scientificName) we are likely to notice some differences.</p>
<p>For example, say we were interested in downloading observations of <em>Dendrobium</em>, one of the largest genera of Orchids. Let’s download occurrence data of this genus using galah, and add <code>raw_scientificName</code> &amp; <code>taxonomicStatus</code> information columns to our download.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">galah_config</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">atlas   =</span> <span class="st">"Australia"</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">email   =</span> <span class="fu">Sys.getenv</span>(<span class="st">"ALA_EMAIL"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Download Dendrobium occurrences</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>orchids <span class="ot">&lt;-</span> <span class="fu">galah_call</span>() <span class="sc">|&gt;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_identify</span>(<span class="st">"Dendrobium"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_select</span>(<span class="at">group =</span> <span class="st">"basic"</span>, raw_scientificName, taxonomicStatus) <span class="sc">|&gt;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">atlas_occurrences</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Checking queue
Current queue size: 1 inqueue . running .</code></pre>
</div>
</div>
<p>If we filter our data to data without an “accepted” taxonomic status and compare a random group of names (rows 30 to 50), we’ll see a few names with differing names between the <code>raw_scientificName</code> and <code>scientificName</code></p>
<!-- Andrew: I got the message "new names", telling me to use scientificName...4
and ...9? From the download query? No idea what that is about, but had to change
the code below from scientificName and raw scientific name to those names, or it
wouldn't run for me -->
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>orchids <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(taxonomicStatus), <span class="co"># return names that aren't flagged as "accepted"</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>scientificName...<span class="dv">4</span> <span class="sc">%in%</span> scientificName...<span class="dv">9</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(scientificName...<span class="dv">4</span>, scientificName...<span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">30</span><span class="sc">:</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 2
   scientificName...4              scientificName...9                           
   &lt;chr&gt;                           &lt;chr&gt;                                        
 1 Dendrobium concavissimum        Dendrobium concavissimum J.J.Sm.             
 2 Dendrobium concavissimum        Dendrobium concavissimum J.J.Sm.             
 3 Dendrobium concavissimum        Dendrobium concavissimum J.J.Sm.             
 4 Dendrobium concavissimum        Dendrobium concavissimum J.J.Sm.             
 5 Dendrobium sect. Calyptrochilus Dendrobium sect. Calyptrochilus Schltr.      
 6 Dendrobium sect. Calyptrochilus Dendrobium sect. Calyptrochilus Schltr.      
 7 Dendrobium sect. Monophyllaea   Monophyllaea                                 
 8 Dendrobium protractum           Dendrobium protractum Dauncey                
 9 Dendrobium protractum           Dendrobium protractum Dauncey                
10 Dendrobium sect. Calyptrochilus Pedilonum sect. Calyptrochilus (Schltr.) Bri…
# ℹ 11 more rows</code></pre>
</div>
</div>
<p>Lucky for us, the Atlas of Living Austrlaia accounts for some of these differences when storing their data to help standardise these data taxonomically. However, this isn’t always the case for every taxonomic clade. Searching by classification is a good first step when you expect to find certain taxonomic classifications within your data set.</p>
<p>It’s useful to include synonyms of the species names you’re interested in your download to ensure you return the data you are interested in.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">search_taxa</span>(<span class="st">"Dendrobium keffordii"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 14
  search_term      scientific_name scientific_name_auth…¹ taxon_concept_id rank 
  &lt;chr&gt;            &lt;chr&gt;           &lt;chr&gt;                  &lt;chr&gt;            &lt;chr&gt;
1 Dendrobium keff… Grastidium bai… (F.Muell.) Rauschert   https://id.biod… spec…
# ℹ abbreviated name: ¹​scientific_name_authorship
# ℹ 9 more variables: match_type &lt;chr&gt;, kingdom &lt;chr&gt;, phylum &lt;chr&gt;,
#   class &lt;chr&gt;, order &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;, species &lt;chr&gt;,
#   issues &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">search_taxa</span>(<span class="st">"Grastidium baileyi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 14
  search_term      scientific_name scientific_name_auth…¹ taxon_concept_id rank 
  &lt;chr&gt;            &lt;chr&gt;           &lt;chr&gt;                  &lt;chr&gt;            &lt;chr&gt;
1 Grastidium bail… Grastidium bai… (F.Muell.) Rauschert   https://id.biod… spec…
# ℹ abbreviated name: ¹​scientific_name_authorship
# ℹ 9 more variables: match_type &lt;chr&gt;, kingdom &lt;chr&gt;, phylum &lt;chr&gt;,
#   class &lt;chr&gt;, order &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;, species &lt;chr&gt;,
#   issues &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Not sure what was meant to happen here</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(galah)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">galah_call</span>() <span class="sc">|&gt;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_filter</span>(year <span class="sc">&gt;</span> <span class="dv">2019</span>) <span class="sc">|&gt;</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">atlas_counts</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
     count
     &lt;int&gt;
1 27282361</code></pre>
</div>
</div>
</section>
</section>
<section id="spatial-filtering" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="spatial-filtering"><span class="header-section-number">6.5</span> Spatial filtering</h2>
<!-- Fonti notes:-->
<!-- Work in progess -->
<!-- Narrowing your results to a specific spatial area- using `galah_geolocate`
or by regions etc, discussions around whether this is best to be placed in this
chapter to assist with expaning scope has been raised.  -->
<!-- Read in shpfile, transform to polygon -->
<p>We can add spatial filters to download queries, to return only records within a specified area. Spatial filtering , and are useful for long-term analyses of observations in specific regions or areas.</p>
<section id="filter-by-region" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="filter-by-region"><span class="header-section-number">6.5.1</span> Filter by region</h3>
<p>One way to download data is by filtering to an area of interest using fields already in the ALA and {galah}.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">search_fields</span>(<span class="st">"wetlands"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  id    description                                                  type  link 
  &lt;chr&gt; &lt;chr&gt;                                                        &lt;chr&gt; &lt;chr&gt;
1 cl901 Directory of Important Wetlands Directory of Important Wetl… laye… http…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">search_fields</span>(<span class="st">"cl901"</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">search_values</span>(<span class="st">"kakadu"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  field category            
  &lt;chr&gt; &lt;chr&gt;               
1 cl901 Kakadu National Park</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Northern Snake-necked Turtle</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">galah_call</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_identify</span>(<span class="st">"Chelodina oblonga"</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_filter</span>(cl901 <span class="sc">==</span> <span class="st">"Kakadu National Park"</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">atlas_occurrences</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Checking queue
Current queue size: 1 inqueue  running </code></pre>
</div>
<div class="cell-output-display">
<div id="dvelrafgxi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dvelrafgxi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dvelrafgxi thead, #dvelrafgxi tbody, #dvelrafgxi tfoot, #dvelrafgxi tr, #dvelrafgxi td, #dvelrafgxi th {
  border-style: none;
}

#dvelrafgxi p {
  margin: 0;
  padding: 0;
}

#dvelrafgxi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dvelrafgxi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dvelrafgxi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dvelrafgxi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dvelrafgxi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dvelrafgxi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dvelrafgxi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dvelrafgxi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dvelrafgxi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dvelrafgxi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dvelrafgxi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dvelrafgxi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dvelrafgxi .gt_spanner_row {
  border-bottom-style: hidden;
}

#dvelrafgxi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dvelrafgxi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dvelrafgxi .gt_from_md > :first-child {
  margin-top: 0;
}

#dvelrafgxi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dvelrafgxi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dvelrafgxi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dvelrafgxi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dvelrafgxi .gt_row_group_first td {
  border-top-width: 2px;
}

#dvelrafgxi .gt_row_group_first th {
  border-top-width: 2px;
}

#dvelrafgxi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dvelrafgxi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dvelrafgxi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dvelrafgxi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dvelrafgxi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dvelrafgxi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dvelrafgxi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dvelrafgxi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dvelrafgxi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dvelrafgxi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dvelrafgxi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dvelrafgxi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dvelrafgxi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dvelrafgxi .gt_left {
  text-align: left;
}

#dvelrafgxi .gt_center {
  text-align: center;
}

#dvelrafgxi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dvelrafgxi .gt_font_normal {
  font-weight: normal;
}

#dvelrafgxi .gt_font_bold {
  font-weight: bold;
}

#dvelrafgxi .gt_font_italic {
  font-style: italic;
}

#dvelrafgxi .gt_super {
  font-size: 65%;
}

#dvelrafgxi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dvelrafgxi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dvelrafgxi .gt_indent_1 {
  text-indent: 5px;
}

#dvelrafgxi .gt_indent_2 {
  text-indent: 10px;
}

#dvelrafgxi .gt_indent_3 {
  text-indent: 15px;
}

#dvelrafgxi .gt_indent_4 {
  text-indent: 20px;
}

#dvelrafgxi .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="decimalLatitude" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">decimalLatitude</th>
<th id="decimalLongitude" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">decimalLongitude</th>
<th id="eventDate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">eventDate</th>
<th id="scientificName" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">scientificName</th>
<th id="taxonConceptID" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">taxonConceptID</th>
<th id="recordID" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">recordID</th>
<th id="dataResourceName" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">dataResourceName</th>
<th id="occurrenceStatus" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">occurrenceStatus</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="decimalLatitude">-12.71089</td>
<td class="gt_row gt_right" headers="decimalLongitude">132.5883</td>
<td class="gt_row gt_right" headers="eventDate">2018-03-28 05:47:34</td>
<td class="gt_row gt_left" headers="scientificName">Chelodina (Macrochelodina) oblonga</td>
<td class="gt_row gt_left" headers="taxonConceptID">https://biodiversity.org.au/afd/taxa/967549e7-7fa9-4770-b86e-5e3520d3c43d</td>
<td class="gt_row gt_left" headers="recordID">71f1273d-f425-4d49-8ea7-86bee30bb018</td>
<td class="gt_row gt_left" headers="dataResourceName">iNaturalist Australia</td>
<td class="gt_row gt_left" headers="occurrenceStatus">PRESENT</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="decimalLatitude">-12.66610</td>
<td class="gt_row gt_right" headers="decimalLongitude">132.4898</td>
<td class="gt_row gt_right" headers="eventDate">1998-10-23 00:00:00</td>
<td class="gt_row gt_left" headers="scientificName">Chelodina (Macrochelodina) oblonga</td>
<td class="gt_row gt_left" headers="taxonConceptID">https://biodiversity.org.au/afd/taxa/967549e7-7fa9-4770-b86e-5e3520d3c43d</td>
<td class="gt_row gt_left" headers="recordID">a60cb14f-a2b0-48d2-8990-f088d7f07f5d</td>
<td class="gt_row gt_left" headers="dataResourceName">Fauna Atlas N.T.</td>
<td class="gt_row gt_left" headers="occurrenceStatus">PRESENT</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="decimalLatitude">-12.60000</td>
<td class="gt_row gt_right" headers="decimalLongitude">132.8800</td>
<td class="gt_row gt_right" headers="eventDate">1982-09-02 00:00:00</td>
<td class="gt_row gt_left" headers="scientificName">Chelodina (Macrochelodina) oblonga</td>
<td class="gt_row gt_left" headers="taxonConceptID">https://biodiversity.org.au/afd/taxa/967549e7-7fa9-4770-b86e-5e3520d3c43d</td>
<td class="gt_row gt_left" headers="recordID">3a3825db-9ca9-4226-b513-25fc1d5564ad</td>
<td class="gt_row gt_left" headers="dataResourceName">Northern Territory Museum and Art Gallery provider for OZCAM</td>
<td class="gt_row gt_left" headers="occurrenceStatus">PRESENT</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="decimalLatitude">-12.53258</td>
<td class="gt_row gt_right" headers="decimalLongitude">132.3971</td>
<td class="gt_row gt_right" headers="eventDate">1981-04-30 00:00:00</td>
<td class="gt_row gt_left" headers="scientificName">Chelodina (Macrochelodina) oblonga</td>
<td class="gt_row gt_left" headers="taxonConceptID">https://biodiversity.org.au/afd/taxa/967549e7-7fa9-4770-b86e-5e3520d3c43d</td>
<td class="gt_row gt_left" headers="recordID">3bd79448-e5bd-44c6-a819-18535fdc7985</td>
<td class="gt_row gt_left" headers="dataResourceName">Fauna Atlas N.T.</td>
<td class="gt_row gt_left" headers="occurrenceStatus">PRESENT</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="decimalLatitude">-12.46670</td>
<td class="gt_row gt_right" headers="decimalLongitude">132.5000</td>
<td class="gt_row gt_right" headers="eventDate">NA</td>
<td class="gt_row gt_left" headers="scientificName">Chelodina (Macrochelodina) oblonga</td>
<td class="gt_row gt_left" headers="taxonConceptID">https://biodiversity.org.au/afd/taxa/967549e7-7fa9-4770-b86e-5e3520d3c43d</td>
<td class="gt_row gt_left" headers="recordID">f1a8f89a-1d56-4b45-89b8-4709c2adbf49</td>
<td class="gt_row gt_left" headers="dataResourceName">Fauna Atlas N.T.</td>
<td class="gt_row gt_left" headers="occurrenceStatus">PRESENT</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show how to download data in galah with a bounding box</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filter-by-vector-geometry" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="filter-by-vector-geometry"><span class="header-section-number">6.5.2</span> Filter by vector geometry</h3>
<p>Vector geometry can also be used to filter observations. The advantage of this method is that you can return data for very specific shapes or areas. The <code>galah_geolocate()</code> function accepts vector geometries in the form of simple feature objects, shapefiles or Well-Known Text (WKT) strings.</p>
<p>In this example, we first construct a simple polygon for a theoretical “site A”, using a WKT string. You could also import an existing geometry such as a shapefile. To work with spatial vector data we use the <code>sf</code> package. The function <code>st_as_sf()</code> is used to create a simple feature with type polygon, from our WKT string. The coordinate reference system (CRS) of our WKT is 4326, so we need to use <code>st_set_crs()</code> to set this value for our simple feature object. Now we can use this object in a download query using <code>galah_geolocate()</code> to filter the records.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>my_polygon <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">site =</span> <span class="st">"A"</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">geometry =</span> <span class="st">"POLYGON((149.96704 -32.08651, 150.64294 -32.2957, 151.18152 -32.58776, 150.98376 -33.10617, 149.86316 -32.83581, 149.59900 -31.90793, 149.96704 -32.08651))"</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>my_polygon_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(my_polygon, <span class="at">wkt =</span> <span class="st">"geometry"</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_crs</span>(<span class="dv">4326</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Satin Bowerbird (*Ptilonorhynchus violaceus*</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>satin_bb <span class="ot">&lt;-</span> <span class="fu">galah_call</span>() <span class="sc">|&gt;</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_identify</span>(<span class="st">"Ptilonorhynchus violaceus"</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_geolocate</span>(my_polygon_sf) <span class="sc">|&gt;</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">atlas_occurrences</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Checking queue
Current queue size: 1 inqueue .</code></pre>
</div>
</div>
<p>Our download query returns only the records from within our polygon. We can visualise the result using <code>ggplot2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>aus <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(ozmaps<span class="sc">::</span>ozmap_country, <span class="dv">4326</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> aus) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> my_polygon_sf, <span class="at">fill =</span> <span class="st">"springgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> satin_bb, <span class="at">color =</span> <span class="st">"orchid1"</span>, <span class="fu">aes</span>(</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> decimalLongitude,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> decimalLatitude</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">148</span>, <span class="dv">153</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">34</span>, <span class="sc">-</span><span class="dv">31</span>)) <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="access_download_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="filter-by-bounding-box" class="level3" data-number="6.5.3">
<h3 data-number="6.5.3" class="anchored" data-anchor-id="filter-by-bounding-box"><span class="header-section-number">6.5.3</span> Filter by bounding box</h3>
<p>Another way to filter a query is by using a bounding box. This is similar to the polygon method shown above. We again use <code>galah_geolocate()</code>, but set the type arguement, which is polygon by default to “bbox”. As a result, the provided POLYGON or MULTIPOLYGON will be converted into the smallest bounding box (rectangle) that contains the POLYGON. In this case, records will be included that may not exactly lie inside the provided shape.</p>
</section>
</section>
<section id="refining-your-download-query" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="refining-your-download-query"><span class="header-section-number">6.6</span> Refining your download query</h2>
<p>Open access biodiversity data comes from many different data sources such as government monitoring programs, museums, herbaria, research projects, and citizen science apps. As such, data type and quality can vary considerably. For example, museums harbour older records that are associated with a preserved specimens. These data often contain lots of extra information (metadata) about a specific specimen and its location. On the other hand, data sourced from citizen science apps like iNaturalist or eBird may have less extensive metadata in comparison, but can include associated images or sounds.</p>
<p>Refining your download query is useful for downloading only records that meet your project requirements, or filting records that may be of a lower quality. In any case, refining a dowload query where possible has the benifit of reducing filtering you would otherwise need to perform locally, and also reducing download size. Below we have illustrate a few ways of refining your download query using <code>galah_filter</code>.</p>
<section id="by-year" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="by-year"><span class="header-section-number">6.6.1</span> By Year</h3>
<p>Generally, old data records tend to be insufficient or less reliable as taxonomic knowledge and GPS tools were not readily available. For this reason, many users consider removing all occurrence records before a certain year to increase data precision <span class="citation" data-cites="gueta_quantifying_2016 marsh_accounting_2022">(<a href="references.html#ref-gueta_quantifying_2016" role="doc-biblioref">Gueta and Carmel 2016</a>; <a href="references.html#ref-marsh_accounting_2022" role="doc-biblioref">Marsh et al. 2022</a>)</span>.</p>
<p>Choosing the year ‘cut-off’ is relatively arbitary, but the most commonly used year is 1945 <span class="citation" data-cites="zizka_no_2020 fuhrding-potschkat_influence_2022">(<a href="references.html#ref-zizka_no_2020" role="doc-biblioref">Zizka et al. 2020</a>; <a href="references.html#ref-fuhrding-potschkat_influence_2022" role="doc-biblioref">Führding-Potschkat, Kreft, and Ickert-Bond 2022</a>)</span>, although some studies discard all data collected before 1990 <span class="citation" data-cites="gueta_quantifying_2016 marsh_accounting_2022">(<a href="references.html#ref-gueta_quantifying_2016" role="doc-biblioref">Gueta and Carmel 2016</a>; <a href="references.html#ref-marsh_accounting_2022" role="doc-biblioref">Marsh et al. 2022</a>)</span>.</p>
<p>Here we will narrow the Pink Robin query from above to records after 1945 using <code>galah_filter</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pink_robin_post1945 <span class="ot">&lt;-</span> <span class="fu">galah_call</span>() <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_identify</span>(<span class="st">"Petroica rodinogaster"</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_filter</span>(year <span class="sc">&gt;</span> <span class="dv">1945</span>) <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">atlas_occurrences</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Checking queue
Current queue size: 1 inqueue  running .</code></pre>
</div>
</div>
</section>
<section id="basis-of-record" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="basis-of-record"><span class="header-section-number">6.6.2</span> Basis of record</h3>
<p>Basis of record is a <a href="https://dwc.tdwg.org/terms/#dwc:basisOfRecord">Darwin Core term</a> that refers to the specific nature of the occurrence record. It can be used to refine your data download and ensure consistency when consolidating data from multiple organisations <span class="citation" data-cites="fuhrding-potschkat_influence_2022">(<a href="references.html#ref-fuhrding-potschkat_influence_2022" role="doc-biblioref">Führding-Potschkat, Kreft, and Ickert-Bond 2022</a>)</span>.</p>
<p>There are 6 different classes for basis of record:</p>
<ul>
<li>Living Specimen - a specimen that is alive, e.g.&nbsp;a living plant in a national park</li>
<li>Preserved Specimen - a specimen that has been preserved, for example, a dried plant on an herbarium sheet</li>
<li>Fossil Specimen - a preserved specimen that is a fossil</li>
<li>Material Sample - a genetic or environmental sample</li>
<li>Material Citation - A reference to, or citation of, a specimen in scholarly publications, e.g a citation of a physical specimen in a scientific journal</li>
<li>Human Observation - an output of human observation process e.g.&nbsp;evidence of an occurrence taken from field notes or an occurrence without any physical evidence</li>
<li>Machine Observation - An output of a machine observation process e.g.&nbsp;a photograph, a video, an audio recording, a remote sensing image or an occurrence record based on telemetry.</li>
</ul>
<p>Depending on your data scope, it may be practical to limit data that can be traced to a physical specimen or observation <span class="citation" data-cites="godfree_implications_2021">(<a href="references.html#ref-godfree_implications_2021" role="doc-biblioref">Godfree et al. 2021</a>)</span>, which we do for the Pink Robin below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>tractable_records <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"LIVING_SPECIMEN"</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"PRESERVED_SPECIMEN"</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MATERIAL_SAMPLE"</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MACHINE_OBSERVATION"</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>pink_robin_tractable <span class="ot">&lt;-</span> <span class="fu">galah_call</span>() <span class="sc">|&gt;</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_identify</span>(<span class="st">"Petroica rodinogaster"</span>) <span class="sc">|&gt;</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_filter</span>(basisOfRecord <span class="sc">==</span> tractable_records) <span class="sc">|&gt;</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">atlas_occurrences</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Checking queue
Current queue size: 1 inqueue </code></pre>
</div>
</div>
</section>
<section id="assertions" class="level3" data-number="6.6.3">
<h3 data-number="6.6.3" class="anchored" data-anchor-id="assertions"><span class="header-section-number">6.6.3</span> Assertions</h3>
<p>Data infrastructures use assertions to internally grade the quality, completeness and consistency of each occurrence record. Assertions take values of either 1 or 0, indicating the presence or absence of the data quality issue. Note that assertions may vary depending what atlas you have configured to. You can see the available assertions and their descriptions using:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_all</span>(<span class="st">"assertions"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 114 × 4
   id                                 description                 category type 
   &lt;chr&gt;                              &lt;chr&gt;                       &lt;chr&gt;    &lt;chr&gt;
 1 AMBIGUOUS_COLLECTION               Ambiguous collection        Warning  asse…
 2 AMBIGUOUS_INSTITUTION              Ambiguous institution       Warning  asse…
 3 BASIS_OF_RECORD_INVALID            Basis of record badly form… Warning  asse…
 4 biosecurityIssue                   Biosecurity issue           Error    asse…
 5 COLLECTION_MATCH_FUZZY             Collection match fuzzy      Warning  asse…
 6 COLLECTION_MATCH_NONE              Collection not matched      Warning  asse…
 7 CONTINENT_COUNTRY_MISMATCH         Continent country mismatch  Warning  asse…
 8 CONTINENT_DERIVED_FROM_COORDINATES Continent derived from coo… Warning  asse…
 9 CONTINENT_INVALID                  Continent invalid           Warning  asse…
10 COORDINATE_INVALID                 Coordinate invalid          Warning  asse…
# ℹ 104 more rows</code></pre>
</div>
</div>
<p>Once you have decided which assertions are important for your project you can further refine your download. To retrieve all the assertions for your query use <code>galah_select(group = "assertions")</code></p>
<!-- Explain:  -->
<!-- Assertions are logical flags, TRUE is presence of issue denoted in column name -->
<!-- User to choose which ones are relevant to their project and filter in query -->
<!-- For exclusions using multiple assertions (Currently throws errors, need to think carefully about != means for logical assertions...) -->
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>probin_assertions <span class="ot">&lt;-</span> <span class="fu">galah_call</span>() <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_identify</span>(<span class="st">"Petroica rodinogaster"</span>) <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_filter</span>(basisOfRecord <span class="sc">==</span> tractable_records) <span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_select</span>(<span class="at">group =</span> <span class="st">"assertions"</span>) <span class="sc">|&gt;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">atlas_occurrences</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Checking queue
Current queue size: 1 inqueue .</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preview all the assertions</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">colnames</span>(probin_assertions), <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "recordID"                           "AMBIGUOUS_COLLECTION"              
 [3] "AMBIGUOUS_INSTITUTION"              "BASIS_OF_RECORD_INVALID"           
 [5] "biosecurityIssue"                   "COLLECTION_MATCH_FUZZY"            
 [7] "COLLECTION_MATCH_NONE"              "CONTINENT_COUNTRY_MISMATCH"        
 [9] "CONTINENT_DERIVED_FROM_COORDINATES" "CONTINENT_INVALID"                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A quick way to check which assertions contain TRUEs</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>probin_assertions <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>recordID) <span class="sc">|&gt;</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colSums</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             AMBIGUOUS_COLLECTION 
                                                0 
                            AMBIGUOUS_INSTITUTION 
                                                0 
                          BASIS_OF_RECORD_INVALID 
                                                0 
                                 biosecurityIssue 
                                                0 
                           COLLECTION_MATCH_FUZZY 
                                                0 
                            COLLECTION_MATCH_NONE 
                                                0 
                       CONTINENT_COUNTRY_MISMATCH 
                                                0 
               CONTINENT_DERIVED_FROM_COORDINATES 
                                                0 
                                CONTINENT_INVALID 
                                                0 
                               COORDINATE_INVALID 
                                                0 
                          COORDINATE_OUT_OF_RANGE 
                                                0 
                     COORDINATE_PRECISION_INVALID 
                                                2 
                           COORDINATE_REPROJECTED 
                                                6 
                   COORDINATE_REPROJECTION_FAILED 
                                                0 
               COORDINATE_REPROJECTION_SUSPICIOUS 
                                                0 
                               COORDINATE_ROUNDED 
                                                0 
            COORDINATE_UNCERTAINTY_METERS_INVALID 
                                              143 
                    COORDINATES_CENTRE_OF_COUNTRY 
                                                0 
              COORDINATES_CENTRE_OF_STATEPROVINCE 
                                                0 
                      COUNTRY_COORDINATE_MISMATCH 
                                                0 
                 COUNTRY_DERIVED_FROM_COORDINATES 
                                                0 
                                  COUNTRY_INVALID 
                                                0 
                                 COUNTRY_MISMATCH 
                                                0 
                            DEPTH_MIN_MAX_SWAPPED 
                                                0 
                                DEPTH_NON_NUMERIC 
                                                0 
                                 DEPTH_NOT_METRIC 
                                                0 
                                   DEPTH_UNLIKELY 
                                                0 
                                  detectedOutlier 
                                                0 
                      DIFFERENT_OWNER_INSTITUTION 
                                                0 
                        ELEVATION_MIN_MAX_SWAPPED 
                                                0 
                            ELEVATION_NON_NUMERIC 
                                                0 
                             ELEVATION_NOT_METRIC 
                                                0 
                               ELEVATION_UNLIKELY 
                                                0 
                                 FIRST_OF_CENTURY 
                                                0 
                                   FIRST_OF_MONTH 
                                               14 
                                    FIRST_OF_YEAR 
                                               26 
                            FOOTPRINT_SRS_INVALID 
                                                0 
                            FOOTPRINT_WKT_INVALID 
                                                0 
                           FOOTPRINT_WKT_MISMATCH 
                                                0 
                     GEODETIC_DATUM_ASSUMED_WGS84 
                                              234 
                           GEODETIC_DATUM_INVALID 
                                                0 
                     GEOREFERENCE_POST_OCCURRENCE 
                                                2 
                       GEOREFERENCED_DATE_INVALID 
                                                0 
                      GEOREFERENCED_DATE_UNLIKELY 
                                                0 
                                  geospatialIssue 
                                                0 
                                  habitatMismatch 
                                                0 
                                ID_PRE_OCCURRENCE 
                                                0 
                          identificationIncorrect 
                                                0 
                          IDENTIFIED_DATE_INVALID 
                                                0 
                         IDENTIFIED_DATE_UNLIKELY 
                                                0 
INDIVIDUAL_COUNT_CONFLICTS_WITH_OCCURRENCE_STATUS 
                                                0 
                         INDIVIDUAL_COUNT_INVALID 
                                                2 
                  INSTITUTION_COLLECTION_MISMATCH 
                                                0 
                          INSTITUTION_MATCH_FUZZY 
                                                0 
                           INSTITUTION_MATCH_NONE 
                                                0 
                             INTERPRETATION_ERROR 
                                                0 
                          INVALID_SCIENTIFIC_NAME 
                                                0 
                            LOCATION_NOT_SUPPLIED 
                                               21 
                          MISSING_COLLECTION_DATE 
                                               43 
                            MISSING_GEODETICDATUM 
                                              234 
                        MISSING_GEOREFERENCE_DATE 
                                              336 
                          MISSING_GEOREFERENCEDBY 
                                              336 
                     MISSING_GEOREFERENCEPROTOCOL 
                                              281 
                      MISSING_GEOREFERENCESOURCES 
                                              331 
           MISSING_GEOREFERENCEVERIFICATIONSTATUS 
                                              338 
                                MISSING_TAXONRANK 
                                              196 
                            MODIFIED_DATE_INVALID 
                                                0 
                           MODIFIED_DATE_UNLIKELY 
                                                0 
                          MULTIMEDIA_DATE_INVALID 
                                                0 
                           MULTIMEDIA_URI_INVALID 
                                                3 
                                NAME_NOT_SUPPLIED 
                                                4 
  OCCURRENCE_STATUS_INFERRED_FROM_BASIS_OF_RECORD 
                                                0 
 OCCURRENCE_STATUS_INFERRED_FROM_INDIVIDUAL_COUNT 
                                                1 
                     OCCURRENCE_STATUS_UNPARSABLE 
                                                0 
                        PRESUMED_NEGATED_LATITUDE 
                                                0 
                       PRESUMED_NEGATED_LONGITUDE 
                                                0 
                      PRESUMED_SWAPPED_COORDINATE 
                                                0 
                            RECORDED_DATE_INVALID 
                                               59 
                           RECORDED_DATE_MISMATCH 
                                                0 
                           RECORDED_DATE_UNLIKELY 
                                                0 
                           REFERENCES_URI_INVALID 
                                                0 
                       SENSITIVITY_REPORT_INVALID 
                                                0 
                  SENSITIVITY_REPORT_NOT_LOADABLE 
                                                0 
                        STATE_COORDINATE_MISMATCH 
                                                0 
                           TAXON_AFFINITY_SPECIES 
                                                0 
                             TAXON_CONFER_SPECIES 
                                                0 
                              TAXON_DEFAULT_MATCH 
                                                0 
                                      TAXON_ERROR 
                                                0 
                                   TAXON_EXCLUDED 
                                                0 
                        TAXON_EXCLUDED_ASSOCIATED 
                                                0 
                                    TAXON_HOMONYM 
                                                0 
                      TAXON_INDETERMINATE_SPECIES 
                                                0 
                            TAXON_MATCH_AGGREGATE 
                                                0 
                                TAXON_MATCH_FUZZY 
                                                0 
                           TAXON_MATCH_HIGHERRANK 
                                                0 
                                 TAXON_MATCH_NONE 
                                                0 
                                 TAXON_MISAPPLIED 
                                                0 
                         TAXON_MISAPPLIED_MATCHED 
                                                0 
                       TAXON_PARENT_CHILD_SYNONYM 
                                                0 
                           TAXON_QUESTION_SPECIES 
                                                0 
                             TAXON_SCOPE_MISMATCH 
                                                0 
                             TAXON_SPECIES_PLURAL 
                                                0 
                                   taxonomicIssue 
                                                0 
                                    temporalIssue 
                                                0 
                              TYPE_STATUS_INVALID 
                                                0 
                         UNCERTAINTY_IN_PRECISION 
                                                0 
                        UNCERTAINTY_NOT_SPECIFIED 
                                                0 
                             UNKNOWN_COUNTRY_NAME 
                                                0 
                                  UNKNOWN_KINGDOM 
                                                0 
                     UNRECOGNISED_COLLECTION_CODE 
                                                0 
                    UNRECOGNISED_INSTITUTION_CODE 
                                                0 
                               userAssertionOther 
                                                0 
                              userDuplicateRecord 
                                                0 
                                  ZERO_COORDINATE 
                                                0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Requery for single assertion</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>probin_subset <span class="ot">&lt;-</span> <span class="fu">galah_call</span>() <span class="sc">|&gt;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_identify</span>(<span class="st">"Petroica rodinogaster"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_filter</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    basisOfRecord <span class="sc">==</span> tractable_records,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    identificationIncorrect <span class="sc">==</span> <span class="cn">FALSE</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">galah_select</span>(<span class="at">group =</span> <span class="st">"basic"</span>) <span class="sc">|&gt;</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">atlas_counts</span>()</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co"># For exclusions using multiple assertions [Currently throws errors, need to think carefully about != means for logical assertions...]</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># assertions &lt;- c("UNKNOWN_KINGDOM", "identificationIncorrect",</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co">#                    "COORDINATE_PRECISION_MISMATCH", "MISSING_GEODETICDATUM")</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co"># galah_call() |&gt;</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co">#   galah_identify("Petroica rodinogaster") |&gt;</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   galah_filter(basisOfRecord == tractable_records,</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="co">#                assertions != IA_assertions) |&gt;</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="co">#   atlas_counts()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-fuhrding-potschkat_influence_2022" class="csl-entry" role="listitem">
Führding-Potschkat, Petra, Holger Kreft, and Stefanie M. Ickert-Bond. 2022. <span>“Influence of Different Data Cleaning Solutions of Point-Occurrence Records on Downstream Macroecological Diversity Models.”</span> <em>Ecology and Evolution</em> 12 (8): e9168. <a href="https://doi.org/10.1002/ece3.9168">https://doi.org/10.1002/ece3.9168</a>.
</div>
<div id="ref-godfree_implications_2021" class="csl-entry" role="listitem">
Godfree, Robert C., Nunzio Knerr, Francisco Encinas-Viso, David Albrecht, David Bush, D. Christine Cargill, Mark Clements, et al. 2021. <span>“Implications of the 2019–2020 Megafires for the Biogeography and Conservation of <span>Australian</span> Vegetation.”</span> <em>Nature Communications</em> 12 (1): 1023. <a href="https://doi.org/10.1038/s41467-021-21266-5">https://doi.org/10.1038/s41467-021-21266-5</a>.
</div>
<div id="ref-gueta_quantifying_2016" class="csl-entry" role="listitem">
Gueta, Tomer, and Yohay Carmel. 2016. <span>“Quantifying the Value of User-Level Data Cleaning for Big Data: <span>A</span> Case Study Using Mammal Distribution Models.”</span> <em>Ecological Informatics</em> 34 (July): 139–45. <a href="https://doi.org/10.1016/j.ecoinf.2016.06.001">https://doi.org/10.1016/j.ecoinf.2016.06.001</a>.
</div>
<div id="ref-marsh_accounting_2022" class="csl-entry" role="listitem">
Marsh, Jessica R., Payal Bal, Hannah Fraser, Kate Umbers, Tanya Latty, Aaron Greenville, Libby Rumpff, and John C. Z. Woinarski. 2022. <span>“Accounting for the Neglected: <span>Invertebrate</span> Species and the 2019–2020 <span>Australian</span> Megafires.”</span> <em>Global Ecology and Biogeography</em> n/a (n/a). <a href="https://doi.org/10.1111/geb.13550">https://doi.org/10.1111/geb.13550</a>.
</div>
<div id="ref-zizka_no_2020" class="csl-entry" role="listitem">
Zizka, Alexander, Fernanda Antunes Carvalho, Alice Calvente, Mabel Rocio Baez-Lizarazo, Andressa Cabral, Jéssica Fernanda Ramos Coelho, Matheus Colli-Silva, Mariana Ramos Fantinati, Moabe F Fernandes, and Thais Ferreira-Araújo. 2020. <span>“No One-Size-Fits-All Solution to Clean <span>GBIF</span>.”</span> <em>PeerJ</em> 8: e9916.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./access_taxonomy.html" class="pagination-link  aria-label=" &lt;span="" and="" open="" source="" data&lt;="" span&gt;"="">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Taxnomy and open source data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./access_inspect.html" class="pagination-link" aria-label="<span class='chapter-number'>7</span>&nbsp; <span class='chapter-title'>Initial inspection</span>">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Initial inspection</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>The Data Cleaning booklet is a product of the Atlas of Living Australia.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>