---
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r, setup, include=FALSE}
knitr::opts_chunk$set(
  comment = '', 
  fig.width = 6, 
  fig.height = 6,
  echo = FALSE,
  warning = FALSE
)

library(here)
library(sf)
library(dplyr)
library(ggplot2)
library(tidyverse) # group of packages
library(ozmaps)
```

# Data scope

Data scope pertains to the type of data needed for your project, your research question will help guide the scope of data you need.

Consider the following to in reference to your research aim:

-   What is the **taxonomic** unit of your research interest?
-   What is the **spatial** scale of your project? The entire country? A specific conservation area?

Your data scope may change according to the availability of data for certain research interests. In some instances, rare species tend to have considerably fewer records.

## Taxonomic scope

Where the aim of the study is to gather data on a specific taxonomic unit. This could be a threatened species or a broad taxonomic group. The download query is performed using the scientific name or name of the taxonomic group.

```{r}
#map Lampromicra senator
lampromicra <- arrow::read_parquet(here("data", "galah", "lampromicra"))
aus <- st_transform(ozmaps::ozmap_country, 4326)

 ggplot() +
  geom_sf(data = aus, size = 0.05, fill = "#B7CD96") +
  geom_point(
    data = lampromicra,
    mapping = aes(x = decimalLongitude, y = decimalLatitude, colour = scientificName),
    size = 2,
  ) +
  ylim(-45, -10) +
  xlim(110, 155) +
  theme_void()
```

## Spatial scope

Where the aim is to obtain data for targeted taxa in a given location. In this case, the region name or area boundaries can be used to delimit the area of interest. The example below shows all Insecta orders in the state of Tasmania in Australia

```{r}
insects <- arrow::read_parquet(here("data", "galah","insects"))
aus <- st_transform(ozmaps::ozmap_country, 4326)

ggplot() +
  geom_sf(data = aus, size = 0.05, fill = "#B7CD96") +
  geom_point(
    data = insects,
    mapping = aes(x = decimalLongitude, y = decimalLatitude, colour = order),
    size = 0.3,
  ) +
  ylim(-44, -39) +
  xlim(144.7, 148.5) +
  theme_void()

```

```{r, include=FALSE}
# galah_config(email = "margot.schneider@csiro.au", atlas = "Australia")

# lampromicra <- galah_call() %>%
#   galah_identify("Lampromicra aerea", "Lampromicra senator"
#                  ) %>%
#   galah_filter( year > 1950 & year <= 2022)%>%
#   galah_select(group = "basic")%>%
#   atlas_occurrences()
# 
# arrow::write_parquet(lampromicra, "data/galah/lampromicra")
#
# insects <- galah_call() |>
#   galah_identify("Insecta") |>
#   galah_filter(stateProvince == "Tasmania") |>
#    galah_select(group = "basic", order) |>
#   atlas_occurrences()
# 
# arrow::write_parquet(insects, "data/galah/insects")

```
