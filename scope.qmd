---
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r, setup, include=FALSE}
knitr::opts_chunk$set(
  comment = '', 
  fig.width = 6, 
  fig.height = 6,
  echo = FALSE,
  warning = FALSE
)

library(here)
library(sf)
library(dplyr)
library(ggplot2)
library(tidyverse) # group of packages
library(ozmaps)
library(arrow)
```

# Restricting or increasing data scope

Data scope pertains to the type and breadth of data needed for your project.\
\
\*\*\* Flesh out more information here on the importance of scope \*\*\*

**Your research question will help guide the scope of data you need.**

Consider the following in reference to your research aim:

-   What is the **taxonomic** unit of your research interest?

    *A broader genera or a species? Is it threatened?*

-   What is the **spatial** scale of your project?

    *The entire country? A specific conservation area?*

::: {.callout-note appearance="simple"}
## Note

Your data scope may change according to the availability of data. In some instances (for example), rare species tend to have considerably fewer records.
:::

## Taxonomic scope

**When the aim is to gather data on a specific taxonomic unit, reducing or increasing the taxonomic scope is relevant.** \
\
This might involve understanding its' threatened species status, or, if there is leverage to increase to a broader taxonomic group. \
\
The first data download query is performed using the scientific name, or, name of the taxonomic group.

```{r}
#map Lampromicra senator
lampromicra <- open_dataset("data/galah/lampromicra") |> collect()
aus <- st_transform(ozmaps::ozmap_country, 4326)

 ggplot() +
  geom_sf(data = aus, size = 0.05, fill = "#B7CD96") +
  geom_point(
    data = lampromicra,
    mapping = aes(x = decimalLongitude, y = decimalLatitude, colour = scientificName),
    size = 2,
  ) +
  ylim(-45, -10) +
  xlim(110, 155) +
  theme_void()
```

<aside>

Curious what *Lampromicra senator* looks like?

[![Lampromicra senator perched on a leaf by Dexmond Wells CC-BY-NC 4.0](images/Lampromicra.jpeg){width="800"}](https://images.ala.org.au/store/4/8/8/4/1f4fc763-d21f-4e5d-b803-f931a4c14884/tms/3/2/1.png)

</aside>

## Spatial scope

When the aim is to obtain data for targeted taxa in a given location.\
\
In this case, the region name or area boundaries can be used to delimit the area of interest. \
\
The example below shows all Insect orders in the state of Tasmania in Australia:

<!-- Note that we are plotting only 10% of all dataset here  -->

```{r}
insects <- open_dataset("data/galah/insects") |> collect()
aus <- st_transform(ozmaps::ozmap_country, 4326)

ggplot() +
  geom_sf(data = aus, size = 0.05, fill = "#B7CD96") +
  geom_point(
    data = insects,
    mapping = aes(x = decimalLongitude, y = decimalLatitude, colour = order),
    size = 0.3,
  ) +
  ylim(-44, -39) +
  xlim(144.7, 148.5) +
  theme_void()

```

## Naming authorities

<!-- Define what naming authority is -->

<!-- How to choose -->

<!--   query with your ideal species list, some systems fuzzy match and will have synonyms -->

<!--     getting all the name columns including your own preferred naming authority to check if you back correct -->

### Choosing your taxonomic naming authority

Naming authorities are the different organisations that provide updated or revised lists of species taxonomic splits or taxonomic history following new research. Species names in these lists vary as there may be disagreements as to what distinguishes a new genus, species, subspecies etc. Open source repositories are often provided with conflicting taxonomies that leaving them open to a degree of error.

Choosing a naming authority is, then, one one way to make decisions surrounding taxonomic categorisations of open source biodiversity data. However, deciding what naming authority to use can be both challenging and time consuming. What you choose will depend on your own taxonomic research and evaluation, but, also, your scope. A **spatial** scope will have many species and may need multiple naming authorities. On the other hand, choosing a naming authority can impact your scope by shrinking or enlarging datasets.

1.  Checking changes in the taxonomy of your focus species can be helpful when interpreting old data which may have species names you don't recognize, or, when using data citing a different naming authority to another data set you wish to consolidate it with. This can be achieved by consulting the literature.

2.  Most taxonomic society groups also release annual updates on taxonomy.

In Australia, the [Australian Plant Name Index (APNI)](https://www.anbg.gov.au/apni/) is the primary naming authority for plants. With the [Australian Faunal Directory (AFD)](https://biodiversity.org.au/afd/home) the main taxonomic catalog for animal species. These authorities provide a list of accepted and authoritative names as a template. If you're unsure what naming authority to use and you're looking at Australian species, the APNI and the AFD are a good place to start, especially if the data you're investigating covers a wide range of taxa. If you're investigating specific taxa it's worth checking when the taxonomy was last updated in the APNI or AFD, especially if you know there has been recent changes. If you want to investigate closer, we've provided some links to society groups, in some cases these can be more up to date that the APNI or AFD.

<!-- Is the below content things that were drawn on to write the above? Including references to be inserted? If it isn't, it seems to be repeating things and could probably be deleted. I do like Margot's image though! I think generally the book needs more visuals  -->

## Naming authorities

Accurate species delimitation is crucial for adequate conservation management and understanding evolutionary processes [@mace2004role]. Species-level lists are also the foundation of conservation decisions, such as is the IUCN Red List [@melville21].

The difference in scope might influence if you choose to use a naming authority from a taxonomic society group or multiple broad sources.

## Naming authorities and taxonomy in biodiversity databases

When you download data from different databases you might be faced with inconsistencies between the datasets. This is a challenge that data aggregators face when ingesting and aggregating data. This is a large task with lots of heterogeneity and can lead to errors along the way. To help deal with naming inconsistencies, naming authorities are used by online biodiversity databases in order to classify species \[REF\]. Different databases might use different naming authorities, and you might not agree with their classifications. There may be other issues you are not aware of: For example, the ALA uses multiple naming authorities in a hierarchical format:

(note image is from a helpfile I wrote- we can re-do it so it's consistent with the style of this document)

![](images/image-1066364510.png)

With all that, open source data has many pros, so how does one deal with taxonomic inconsistencies to get the most accurate data in the end?

While this is in theory how the ALAs backbone is built, issues can occur with aggregation leading to potentially serious problems with the taxonomic structure. In addition data can be parsed incorrectly, and the process isn't transparent. Meaning that when the taxonomic backbone is updated, the elements that have changed are untraceable. These issues are not specific to ALA taxonomy, but occur in varying forms among data aggregators.

```{r, include=FALSE}
# Code to generate data that is in this page

# galah_config(email = ALA_mail, atlas = "Australia")

# lampromicra <- galah_call() %>%
#   galah_identify("Lampromicra aerea", "Lampromicra senator"
#                  ) %>%
#   galah_filter( year > 1950 & year <= 2022)%>%
#   galah_select(group = "basic")%>%
#   atlas_occurrences()
# 
# arrow::write_parquet(lampromicra, "data/galah/lampromicra")
#
# insects <- galah_call() |>
#   galah_identify("Insecta") |>
#   galah_filter(stateProvince == "Tasmania") |>
#    galah_select(group = "basic", order) |>
#   atlas_occurrences()
# 
# insects |> 
#   arrow::write_parquet("data/galah/insects")

```
